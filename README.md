# 二维结构动力学仿真与损伤识别研究实践

## 1. 项目简介
本项目主要涉及结构有限元方法和数据驱动损伤识别的编程实践。项目目前包含两个主要模块：
*   **有限元计算内核** —— 基于 Python 开发的二维有限元内核，支持结构静力分析以及基于 Newmark-beta 方法的动力响应计算。
*   **深度学习识别模块** —— 利用仿真数据集，探索通过图神经网络（Graph Transformer）对结构单元损伤情况进行识别的可行性。

---

## 2. 第一部分：有限元程序实现流程

有限元分析内核严格按照标准的数值计算流程进行组织，各核心模块对应的源码路径如下：

### 2.1 建模与参数输入
程序通过 YAML 格式解析结构的几何拓扑（节点、单元）及材料属性。
*   **相关文件**: 
    - `./structure.yaml`: 结构模型定义。
    - `./PyFEM_Dynamics/core/io_parser.py`: 负责几何配置解析与程序对象构建。

### 2.2 单元刚度与质量矩阵计算
工程实践中采用平面拉压桁架单元，其在局部坐标系下的刚度矩阵 $\mathbf{k}^e$ 和一致质量矩阵 $\mathbf{m}^e$ 如下：
$$ \mathbf{k}^e = \frac{EA}{L}\begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix}, \quad \mathbf{m}^e = \frac{\rho A L}{6}\begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix} $$
*   **关键代码**: `./PyFEM_Dynamics/core/element.py` 中的 `get_local_stiffness` 与 `get_local_mass`。

### 2.3 全局矩阵组装
利用直接刚度法将单元矩阵集成至全局总刚度矩阵 $\mathbf{K}$ 和总质量矩阵 $\mathbf{M}$。为了优化计算效率，系统采用了稀疏矩阵存储逻辑。
*   **关键代码**: `./PyFEM_Dynamics/solver/assembler.py`。

### 2.4 边界条件的数值处理
对于本质边界条件，程序实现了**划零划一法**。在该算法下，受约束自由度对应的行列被清零，对角线元素被置为 1，以确保方程组的唯一解。
*   **关键代码**: `./PyFEM_Dynamics/solver/boundary.py`。

### 2.5 动力学时间积分求解
动力学方程的求解基于经典的 **Newmark-$\beta$ 法**（隐式积分）。该算法通过离散时间步迭代获取结构的响应历程：
$$ \mathbf{M}\ddot{\mathbf{u}}_{t+1} + \mathbf{C}\dot{\mathbf{u}}_{t+1} + \mathbf{K}\mathbf{u}_{t+1} = \mathbf{F}_{t+1} $$
其中阻尼矩阵 $\mathbf{C}$ 采用 Rayleigh 比例阻尼模型。
*   **关键代码**: `./PyFEM_Dynamics/solver/integrator.py`。

---

## 3. 第二部分：深度学习识别研究

基于有限元仿真生成的物理数据集，项目进一步探索了深度学习在结构损伤定位中的应用。

### 3.1 训练数据准备
通过有限元程序运行了 **10,000** 次随机工况（包含构件刚度随机折减与非平稳激振），构建了包含位移/加速度响应时程及其对应损伤标签的数据集。
*   **数据生成逻辑**: `./PyFEM_Dynamics/pipeline/data_gen.py`。

### 3.2 图变换网络 (Graph Transformer) 架构
考虑到工程结构天然的拓扑连接特性，模型采用了 **Graph Transformer** 网络：
- **基本原理**: 将结构节点定义为图顶点，杆件定义为边。利用注意力机制（Attention）捕捉不同位置传感器信号在物理拓扑中的空间关联。
- **预测目标**: 输出各单元对应的残余刚度系数。
*   **模型实现**: `./deep_learning/models/gt_model.py`。

### 3.3 训练效果分析
经过 100 轮训练，模型在独立测试集上的评估指标如下：

| 评估指标 | 指标数值 | 结果分析 |
| :--- | :--- | :--- |
| **平均绝对误差 (MAE)** | **0.076** | 预测值与真值之间保持了较低的离差。 |
| **F1-Score** | **0.384** | 在复杂损伤模式的精准定位上展现了一定的识别精度。 |

![训练历史](docs/images/dl_results/gt_history.png)
*   **说明**: 训练历史曲线显示模型收敛状态良好，完成了对物理规律的基础特征提取。

---

## 4. 第三部分：应用展望 (待补充)

本项目为后续研究预留了以下扩展空间：

*   **拟开展工作 1**: 验证模型在不同噪声水平（SNR）下的鲁棒性表现。
*   **拟开展工作 2**: 探索多源传感器数据融合对识别精度的提升效果。

---

## 5. 小结
本项目通过对底层有限元理论的编程实现，系统梳理了结构计算的数值流程，并初步验证了图神经网络在损伤预测中的潜力。目前的开发成果为后续更深入的结构监控研究打下了基础。
